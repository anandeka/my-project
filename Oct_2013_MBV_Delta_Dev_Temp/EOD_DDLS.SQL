CREATE TABLE GDS_GMR_DELTA_STATUS(
PROCESS_ID              VARCHAR2(15),
INTERNAL_GMR_REF_NO     VARCHAR2(15),
IS_NEW_MTD_AR           VARCHAR2(1) DEFAULT 'N',
IS_NEW_YTD_AR           VARCHAR2(1) DEFAULT 'N',
IS_QTY_CHANGED_MTD      VARCHAR2(1) DEFAULT 'N',
IS_OC_CHANGED_MTD       VARCHAR2(1) DEFAULT 'N',
IS_PRICE_CHANGED_MTD    VARCHAR2(1) DEFAULT 'N',
IS_QTY_CHANGED_YTD      VARCHAR2(1) DEFAULT 'N',
IS_OC_CHANGED_YTD       VARCHAR2(1) DEFAULT 'N',
IS_PRICE_CHANGED_YTD    VARCHAR2(1) DEFAULT 'N',
IS_ASSAY_UPDATED_MTD    VARCHAR2(1) DEFAULT 'N',
IS_ASSAY_UPDATED_YTD    VARCHAR2(1) DEFAULT 'N',
IS_ASSAY_UPDATED_MTD_AR VARCHAR2(1) DEFAULT 'N',
IS_ASSAY_UPDATED_YTD_AR VARCHAR2(1) DEFAULT 'N');

CREATE INDEX IDX_GDS1 ON GDS_GMR_DELTA_STATUS(PROCESS_ID);

CREATE TABLE TDIGE_TEMP_DI_GMR_ELEMENT(
CORPORATE_ID          VARCHAR2(15),
INTERNAL_GMR_REF_NO   VARCHAR2(15),
ELEMENT_ID            VARCHAR2(15),
PCDI_ID               VARCHAR2(15));

CREATE INDEX IDX_TDIGE1 ON TDIGE_TEMP_DI_GMR_ELEMENT(CORPORATE_ID);

ALTER TABLE CGCP_CONC_GMR_COG_PRICE ADD 
PRICE_ALLOCATION_METHOD VARCHAR2(30) Default 'Event Based';

CREATE TABLE TAR_TEMP_ALLOC_REPORT(
PROCESS_ID                 VARCHAR2(15),
EOD_TRADE_DATE             DATE,
CORPORATE_ID               VARCHAR2(15 ),
CORPORATE_NAME             VARCHAR2(100 ),
SECTION_NAME               VARCHAR2(200 ),
CP_ID                      VARCHAR2(15 ),
CP_NAME                    VARCHAR2(200 ),
PRODUCT_ID                 VARCHAR2(15 ),
PRODUCT_DESC               VARCHAR2(200 ),
INSTRUMENT_ID              VARCHAR2(15 ),
INSTRUMENT_NAME            VARCHAR2(200 ),
INTERNAL_CONTRACT_REF_NO   VARCHAR2(15 ),
DELIVERY_ITEM_NO           VARCHAR2(15 ),
GMR_REF_NO                 VARCHAR2(30 ),
INTERNAL_GMR_REF_NO        VARCHAR2(15 ),
PF_REF_NO                  VARCHAR2(30 ),
EXTERNAL_REF_NO            VARCHAR2(50 ),
DERIVATIVE_REF_NO          VARCHAR2(30 ),
PURCHASE_QTY               NUMBER(25,4),
SALES_QTY                  NUMBER(25,4),
QTY_UNIT_ID                VARCHAR2(15 ),
QTY_UNIT                   VARCHAR2(15 ),
PRICE                      NUMBER(25,5),
PRICE_UNIT_ID              VARCHAR2(15 ),
PRICE_UNIT_CUR_ID          VARCHAR2(15 ),
PRICE_UNIT_CUR_CODE        VARCHAR2(15 ),
PRICE_UNIT_WEIGHT_UNIT_ID  VARCHAR2(15 ),
PRICE_UNIT_WEIGHT_UNIT     VARCHAR2(15 ),
PRICE_UNIT_WEIGHT          NUMBER(7,2),
PRICE_UNIT_NAME            VARCHAR2(15 ),
PROMPT_MONTH_YEAR          VARCHAR2(15 ),
FX_RATE_PRICE_TO_BASE      NUMBER(38,18),
PRICE_IN_BASE_CCY          NUMBER(38,18),
PRICE_FIXED_DATE           DATE,
AMOUNT                     NUMBER(38,18),
BASE_CUR_ID                VARCHAR2(15 ),
BASE_CUR_NAME              VARCHAR2(25 ),
PCDI_ID                    VARCHAR2(15 ),
IS_ACTIVE                  VARCHAR2(1),
IS_HEDGE_CORRECTION        VARCHAR2(1) NOT NULL,
IS_FIXED_PRICE             VARCHAR2(1) default 'N',
REF_PRICE_UNIT_NAME        VARCHAR2(50),
REF_PRICE                  NUMBER (25,5),
REF_PRICE_VALUE_BASE_CCY    NUMBER(25,5),
REF_PRICE_CUR_ID            VARCHAR2(15));


CREATE INDEX IDX_TAR1 ON TAR_TEMP_ALLOC_REPORT(CORPORATE_ID);

ALTER TABLE MBV_ALLOCATION_REPORT ADD (
IS_HEDGE_CORRECTION            VARCHAR2(1) DEFAULT 'N',
CONTRACT_PRICING_TYPE        VARCHAR2(20) default 'Exchange',
REF_PRICE_UNIT_NAME            VARCHAR2(50),
REF_PRICE_CUR_ID            VARCHAR2(15),
REF_PRICE                    NUMBER(25,5),
REF_PRICE_VALUE_BASE_CCY    NUMBER(25,5));

CREATE TABLE TICP_TEMP_INS_CASH_PRICE(
CORPORATE_ID        VARCHAR2(15 CHAR),
INSTRUMENT_ID        VARCHAR2(15 CHAR),
PRICE_DATE            DATE,
PRICE                NUMBER(25,5),
PRICE_UNIT_ID        VARCHAR2(15 CHAR),
SECTION_NAME        VARCHAR2(15 CHAR),
IS_FIXED_PRICE        VARCHAR2(1 CHAR) DEFAULT 'N',
FIXED_PRICE_DATE    DATE);

CREATE INDEX IDX_TCIP1 ON  TICP_TEMP_INS_CASH_PRICE(CORPORATE_ID);

CREATE TABLE TEMP_INSTRUMENT_CASH_PRICE(
CORPORATE_ID           VARCHAR2 (15 CHAR),
INSTRUMENT_ID          VARCHAR2 (15 CHAR), 
PRICE_DATE             DATE,
PRICE                  NUMBER(25,5),
PRICE_UNIT_ID          VARCHAR2 (15 CHAR),
SECTION_NAME           VARCHAR2 (15 CHAR),
FIXED_PRICE_DATE        DATE,
IS_FIXED_PRICE    VARCHAR2(1 CHAR) DEFAULT 'N');

CREATE INDEX IDX_TICP1 ON TEMP_INSTRUMENT_CASH_PRICE(CORPORATE_ID);

ALTER TABLE MBV_DERIVATIVE_DIFF_REPORT ADD(
TRADE_DATE_CASH_PRICE            NUMBER(25,5),
MONTH_END_CASH_PRICE            NUMBER(25,5),
PNL_ATTRIBUTION_DUE_TO_PRICE    NUMBER(25,5),
PNL_TYPE                        VARCHAR2(50),
BASE_PRICE_UNIT_NAME            VARCHAR2(50),
TRADE_TO_PROD_BASE_QTY_FACTOR    NUMBER,
TRADE_PRICE_IN_BASE_CUR            NUMBER(25,5),
TRADE_DATE_CP_IN_BASE_CUR        NUMBER(25,5),
MONTH_END_PRICE_IN_BASE_CUR        NUMBER(25,5),
MONTH_END_CP_IN_BASE_CUR        NUMBER(25,5),
VALUATION_PRICE_IN_BASE_CUR        NUMBER(25,5));

ALTER TABLE MBV_METAL_BALANCE_VALUATION ADD(
HEDGE_EFFECTIVENESS_MONTH NUMBER(25,5),
RETURNED_MATERIAL_TILL_DATE NUMBER(25,5) DEFAULT 0,
IN_PROCESS_ADJUSTMENT_QTY NUMBER(25,5)DEFAULT 0);

CREATE TABLE ICP_INSTRUMENT_CASH_PRICE
(CORPORATE_ID          VARCHAR2 (15 CHAR), 
INSTRUMENT_ID          VARCHAR2 (15 CHAR),
INSTRUMENT_NAME        VARCHAR2 (50 CHAR),
PHY_PRICE_SOURCE_ID    VARCHAR2 (15 CHAR),
PHY_PRICE_POINT_ID     VARCHAR2 (15 CHAR),
PHY_PRICE_UNIT_ID      VARCHAR2 (15 CHAR),
DER_PRICE_SOURCE_ID    VARCHAR2 (15 CHAR),
DER_PRICE_POINT_ID     VARCHAR2 (15 CHAR),
DER_PRICE_UNIT_ID      VARCHAR2 (15 CHAR),
PHY_MONTH_END_PRICE    NUMBER(25,5),
DER_MONTH_END_PRICE    NUMBER(25,5),
AVAILABLE_PRICE_ID     VARCHAR2 (15 CHAR));
 
DROP MATERIALIZED VIEW FMEIFD_INDEX_FORMULA_DETAILS;
DROP TABLE FMEIFD_INDEX_FORMULA_DETAILS;

CREATE MATERIALIZED VIEW  FMEIFD_INDEX_FORMULA_DETAILS  REFRESH FAST ON DEMAND WITH PRIMARY KEY AS  
SELECT * FROM  FMEIFD_INDEX_FORMULA_DETAILS@EKA_APPDB;


