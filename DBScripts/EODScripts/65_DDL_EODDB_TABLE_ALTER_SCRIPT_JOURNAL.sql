-- Add/modify columns 
alter table TDC_TRADE_DATE_CLOSURE add PROCESS_RUN_COUNT number default 1;

-- Create table
DROP TABLE EOD_EOM_BOOKING_JOURNAL;
create table EOD_EOM_BOOKING_JOURNAL
(
  INTERNAL_CLOSE_OUT_REF_NO  VARCHAR2(15),
  JOURNAL_TYPE               CHAR(100),
  BOOK_TYPE                  CHAR(100),
  CORPORATE_ID               VARCHAR2(15),
  CORPORATE_NAME             VARCHAR2(100),
  PROFIT_CENTER_ID           VARCHAR2(15),
  PROFIT_CENTER_NAME         VARCHAR2(100),
  PROFIT_CENTER_SHORT_NAME   VARCHAR2(100),
  CLOSE_OUT_REF_NO           VARCHAR2(100),
  CLOSE_OUT_DATE             DATE,
  INTERNAL_DERIVATIVE_REF_NO NUMBER(10),
  DERIVATIVE_REF_NO          VARCHAR2(50),
  EXTERNAL_REF_NO            VARCHAR2(50),
  TRADE_TYPE                 VARCHAR2(15),
  CLEARER                    VARCHAR2(100),
  CREATED_BY                 CHAR(50),
  QUANTITY                   NUMBER(25,4),
  QUANTITY_UNIT_ID           VARCHAR2(15),
  QUANTITY_UNIT              VARCHAR2(15),
  CLEARER_COMM_AMT           NUMBER,
  CLEARER_COMM_CUR_ID        VARCHAR2(15),
  CLEARER_COMM_CUR_CODE      VARCHAR2(15),
  TRADE_AMOUNT               NUMBER(25,4),
  TRADE_CURRENCY             VARCHAR2(15),
  TRADE_TO_CORP_FX_RATE      NUMBER(35,10),
  TRADE_AMOUNT_IN_BASE_CCY   NUMBER(25,4),
  CLEARER_COMM_IN_BASE_CCY   NUMBER(25,4),
  BASE_CUR_ID                VARCHAR2(15),
  BASE_CUR_CODE              VARCHAR2(15),
  PRODUCT_ID                 VARCHAR2(50),
  PRODUCT_DESC               VARCHAR2(200),
  EOD_EOM_DATE		     DATE,
  PROCESS		     VARCHAR2(5),
  PROCESS_ID		     VARCHAR2(15),
  DBD_ID		     VARCHAR2(15),
  TRADE_PRICE		     number(25,5),
  TRADE_PRICE_UNIT_ID	     VARCHAR2(20),
  TRADE_PRICE_UNIT	     VARCHAR2(50),
  PRICE_CUR_ID		     VARCHAR2 (15),
  PRICE_CUR_CODE	     VARCHAR2 (15),
  PRICE_WEIGHT	             NUMBER (7,2),
  PRICE_WEIGHT_UNIT_ID       VARCHAR2 (15),
  PRICE_WEIGHT_UNIT          VARCHAR2 (15),
  STRATEGY_ID		     VARCHAR2(15),
  STRATEGY_NAME		     VARCHAR2(100),
  ATTRIBUTE_1		     VARCHAR2(100),
  ATTRIBUTE_2		     VARCHAR2(100),
  ATTRIBUTE_3		     VARCHAR2(100),
  ATTRIBUTE_4		     VARCHAR2(100),
  ATTRIBUTE_5		     VARCHAR2(100)
);

---------
DROP table EOD_EOM_DERIVATIVE_JOURNAL;
-- Create table
create table EOD_EOM_DERIVATIVE_JOURNAL
(
  INTERNAL_DERIVATIVE_REF_NO VARCHAR2(15),
  JOURNAL_TYPE               VARCHAR2(100),
  BOOK_TYPE                  VARCHAR2(100),
  CORPORATE_ID               VARCHAR2(15),
  CORPORATE_NAME             VARCHAR2(100),
  PROFIT_CENTER_ID           VARCHAR2(15),
  PROFIT_CENTER_NAME         VARCHAR2(100),
  PROFIT_CENTER_SHORT_NAME   VARCHAR2(100),
  CATOGERY                   VARCHAR2(100),
  DERIVATIVE_REF_NO          VARCHAR2(50),
  CLEARER                    VARCHAR2(100),
  CLEARER_ID                 VARCHAR2(50),
  TRADER                     VARCHAR2(100),
  STRATEGY_ID                VARCHAR2(15),
  STRATEGY_NAME              VARCHAR2(100),
  TRADE_TYPE                 VARCHAR2(15),
  TRADE_DATE                 DATE,
  PRODUCT_ID                 VARCHAR2(50),
  PRODUCT                    VARCHAR2(200),
  PROMPT_DATE                DATE,
  QUANTITY                   NUMBER(25,4), --qty in base unit
  QUANTITY_UOM               VARCHAR2(10),
  TRADE_PRICE                NUMBER(25,4),
  PRICE_UNIT                 VARCHAR2(10),
  STRIKE_PRICE               NUMBER(25,4),
  STRIKE_PRICE_UNIT          VARCHAR2(10),
  PREMIUM_DISCOUNT           NUMBER(25,4),
  PUT_CALL                   VARCHAR2(50),
  PD_PRICE_UNIT              VARCHAR2(10),
  DECLARATION_DATE           DATE,
  CLEARER_COMMISSION         NUMBER(25,4),
  AVERAGE_PREMIUM            NUMBER(25,4),
  AVERAGE_FROM_DATE          DATE,
  AVERAGE_TO_DATE            DATE,
  PRICE_POINT_NAME           VARCHAR2(100),
  STATUS                     VARCHAR2(50),
  ATTRIBUTE_1                VARCHAR2(100),
  ATTRIBUTE_2                VARCHAR2(100),
  ATTRIBUTE_3                VARCHAR2(100),
  ATTRIBUTE_4                VARCHAR2(100),
  ATTRIBUTE_5                VARCHAR2(100),
  EOD_EOM_DATE               DATE,
  PROCESS                    VARCHAR2(5),
  PROCESS_ID                 VARCHAR2(15),
  DBD_ID                     VARCHAR2(15),
  INSTRUMENT_ID              VARCHAR2(50),
  INSTRUMENT_NAME            VARCHAR2(100),
  INSTRUMENT_TYPE            VARCHAR2(100),
  TRADE_QUANTITY	     NUMBER(25,4),
  TRADE_QUANTITY_UNIT	     VARCHAR2(50),
  EXERCISED_EXPIRED_LOTS     NUMBER (30,5),
  EXERCISED_EXPIRED_QUANTITY NUMBER (35,4),
  EXT_TRADE_REF_NO		VARCHAR2(100),
  INT_TRADE_REF_NO		VARCHAR2(100),
  MASTER_CONT_REF_NO		VARCHAR2(100),
  CLEARER_COMM_TYPE		VARCHAR2(100),
  CLEARER_COMM_PERUNIT		NUMBER(25,4),
  CLEARER_COMM_UNIT		VARCHAR2(50),
  EXCHANGE			VARCHAR2(100),--EXCHANGE NAME
  REMARKS			VARCHAR2(1000)
);
DROP TABLE EOD_EOM_FIXATION_JOURNAL;
-- Create table
create table EOD_EOM_FIXATION_JOURNAL
(
  JOURNAL_TYPE               VARCHAR2(50),
  BOOK_TYPE                  VARCHAR2(50),
  PROCESS_ID                 VARCHAR2(50),
  PROCESS                    VARCHAR2(10),
  EOD_TRADE_DATE             DATE,
  CORPORATE_ID               VARCHAR2(50),
  CORPORATE_NAME             VARCHAR2(100),
  PRODUCT_ID                 VARCHAR2(20),
  PRODUCT_NAME               VARCHAR2(200),
  PROFIT_CENTER_ID           VARCHAR2(20),
  PROFIT_CENTER_NAME         VARCHAR2(100),
  PROFIT_CENTER_SHORT_NAME   VARCHAR2(100),
  PRICE_FIXATION_REFNO       VARCHAR2(100),
  INTERNAL_DERIVATIVE_REF_NO VARCHAR2(20),
  DELIVERY_ITEM_REF_NO       VARCHAR2(50),
  DELIVERY_ITEM_QTY          NUMBER(25,4),
  DELIVERY_ITEM_QTY_UNIT     VARCHAR2(20),
  CONTRACT_REF_NO            VARCHAR2(100),
  CLEARER_PROFILE_ID         VARCHAR2(50),
  CLEARER_NAME               VARCHAR2(200),
  TRADER_NAME                VARCHAR2(100),
  PRICE_FIXATION_DATE        DATE,
  FIXED_QUANTITY             NUMBER(24,4),
  QUANTITY_UNIT              VARCHAR2(20),
  TRADE_PRICE                NUMBER(25,4),
  PRICE_UNIT                 VARCHAR2(50),
  ADJUSTMENT                 NUMBER(25,4),
  FX_RATE                    NUMBER(30,8),
  CONTRACT_PREMIUM           NUMBER(25,4),
  CONTRACT_PREMIUM_UNIT      VARCHAR2(20),
  TOTAL_PRICE                NUMBER(30,5),
  TOTAL_PRICE_UNIT           VARCHAR2(20),
  CONTRACT_ISSUE_DATE        DATE,
  AVERAGE_FROM_DATE          DATE,
  AVERAGE_TO_DATE            DATE,
  SETTLEMENT_PRICE           NUMBER(30,5),
  SETTLEMENT_DATE            DATE,
  STRATEGY_ID                VARCHAR2(50),
  STRATEGY_NAME              VARCHAR2(100),
  ATTRIBUTE_1                VARCHAR2(100),
  ATTRIBUTE_2                VARCHAR2(100),
  ATTRIBUTE_3                VARCHAR2(100),
  ATTRIBUTE_4                VARCHAR2(100),
  ATTRIBUTE_5                VARCHAR2(100),
  BASE_CUR_ID                VARCHAR2(15),
  BASE_CUR_CODE              VARCHAR2(15),
  PRICE_TO_BASE_CONV_RATE    NUMBER(35,10),
  PREM_TO_BASE_CONV_RATE     NUMBER(35,10),
  PRICE_IN_BASE_UNIT         NUMBER(25,5),
  PREMIUM_IN_BASE_UNIT       NUMBER(25,5),
  BASE_PRICE_UNIT            VARCHAR2(20),
  BASE_PRICE_UNIT_ID         VARCHAR2(20),
  TRADE_PRICE_UNIT_ID        VARCHAR2(20),
  PREM_PRICE_UNIT_ID         VARCHAR2(20),
  BASE_QTY_UNIT              VARCHAR2(20),
  BASE_QTY_UNIT_ID           VARCHAR2(20),
  ATTRIBUTE_ID               VARCHAR2(10),
  ATTRIBUTE_NAME             VARCHAR2(100)
);
-- Create/Recreate indexes 
create index EEFJ1 on EOD_EOM_FIXATION_JOURNAL (CORPORATE_ID,PROCESS,PROCESS_ID);


drop table POFH_HISTORY;
-- Create table
create table POFH_HISTORY
(
  CORPORATE_ID                 VARCHAR2(15),
  PROCESS                      VARCHAR2(10),
  PROCESS_ID                   VARCHAR2(15),
  TRADE_DATE                   DATE,
  PCDI_ID                      VARCHAR2(20),
  POFH_ID                      VARCHAR2(15) not null,
  POCD_ID                      VARCHAR2(15),
  INTERNAL_GMR_REF_NO          VARCHAR2(15),
  QP_START_DATE                DATE,
  QP_END_DATE                  DATE,
  QTY_TO_BE_FIXED              NUMBER(35,10),
  PRICED_QTY                   NUMBER(35,10),
  NO_OF_PROMPT_DAYS            NUMBER(35,10),
  PER_DAY_PRICING_QTY          NUMBER(35,10),
  FINAL_PRICE                  NUMBER(35,10),
  FINALIZE_DATE                DATE,
  VERSION                      NUMBER(10),
  IS_ACTIVE                    CHAR(1),
  AVG_PRICE_IN_PRICE_IN_CUR    NUMBER(35,10),
  AVG_FX                       NUMBER(35,10),
  NO_OF_PROMPT_DAYS_FIXED      NUMBER(35,10),
  EVENT_NAME                   VARCHAR2(50),
  DELTA_PRICED_QTY             NUMBER(35,10),
  FINAL_PRICE_IN_PRICING_CUR   NUMBER(35,10),
  INTERNAL_ACTION_REF_NO       VARCHAR2(15),
  HEDGE_CORRECTION_QTY         NUMBER(35,10),
  QP_START_QTY                 NUMBER(35,10),
  IS_PROVESIONAL_ASSAY_EXIST   CHAR(1),
  BALANCE_PRICED_QTY           NUMBER(35,10),
  PER_DAY_HEDGE_CORRECTION_QTY NUMBER(35,10),
  TOTAL_HEDGE_CORRECTED_QTY    NUMBER(35,10),
  IS_NEW                       VARCHAR2(5),
  IS_DELETED                   VARCHAR2(5),
  LATEST_PFC_NO                VARCHAR2(50),
  LATEST_PFC_DATE              DATE,
  LATEST_FIXED_QTY             NUMBER(35,10),
  LATEST_AVG_PRICE             NUMBER(35,10),
  LATEST_PRICE_UNIT_ID         VARCHAR2(20),
  LATEST_ADJ_PRICE             NUMBER(35,10),
  LATEST_ADJ_PRICE_UNIT_ID     VARCHAR2(20)
);
-- Create/Recreate indexes 
create index POFHHD1 on POFH_HISTORY (CORPORATE_ID,PROCESS,PROCESS_ID);
create index POFHHD2 on POFH_HISTORY (CORPORATE_ID,PROCESS,PROCESS_ID,POFH_ID);
